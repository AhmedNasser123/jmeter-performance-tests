name: JMeter Performance Test with Email Link

on:
  push:
    branches:
      - main
      - master
  pull_request:
    branches:
      - main
  workflow_dispatch:

env:
  JMETER_VERSION: '5.6.3'
  TEST_PLAN_PATH: 'google-test-.jmx'
  RP_PROJECT: 'google-test-'
  RECIPIENT_EMAIL: 'aahmeed.naabeel@gmail.com'  # ‚ö†Ô∏è ÿ∫Ÿäÿ± ÿßŸÑÿ•ŸäŸÖŸäŸÑ ŸáŸÜÿß

jobs:
  performance-test:
    runs-on: windows-latest
    
    steps:
    - name: üì• Checkout Repository
      uses: actions/checkout@v4

    - name: ‚òï Setup Java 11
      uses: actions/setup-java@v4
      with:
        distribution: 'temurin'
        java-version: '11'

    - name: üíæ Cache JMeter
      id: cache-jmeter
      uses: actions/cache@v3
      with:
        path: apache-jmeter-${{ env.JMETER_VERSION }}
        key: jmeter-${{ env.JMETER_VERSION }}

    - name: üì• Download JMeter
      if: steps.cache-jmeter.outputs.cache-hit != 'true'
      shell: pwsh
      run: |
        Write-Host "üì• Downloading JMeter $env:JMETER_VERSION..."
        $url = "https://archive.apache.org/dist/jmeter/binaries/apache-jmeter-$env:JMETER_VERSION.zip"
        Invoke-WebRequest -Uri $url -OutFile "jmeter.zip"
        
        Write-Host "üìÇ Extracting JMeter..."
        Expand-Archive -Path jmeter.zip -DestinationPath . -Force
        Remove-Item jmeter.zip
        
        Write-Host "‚úÖ JMeter ready!"

    - name: üß™ Run JMeter Performance Test
      shell: pwsh
      run: |
        $jmeterPath = "apache-jmeter-$env:JMETER_VERSION\bin\jmeter.bat"
        $testPlan = $env:TEST_PLAN_PATH
        
        Write-Host "üöÄ Starting Performance Test..."
        Write-Host "Test Plan: $testPlan"
        
        if (-not (Test-Path $testPlan)) {
            Write-Host "‚ùå ERROR: Test plan not found at: $testPlan"
            exit 1
        }
        
        & $jmeterPath -n -t $testPlan -l results.jtl -e -o html-report -j jmeter.log
        
        if (Test-Path "results.jtl") {
            Write-Host "‚úÖ Results file created"
        }
        
        if (Test-Path "html-report\index.html") {
            Write-Host "‚úÖ HTML report created"
        }

    - name: üìä Generate Test Summary & Email Content
      if: always()
      shell: pwsh
      run: |
        # ÿ®ŸÜÿßÿ° ÿ±Ÿàÿßÿ®ÿ∑ ÿßŸÑŸÄ Artifacts ŸàÿßŸÑŸÄ Workflow
        $workflowUrl = "${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}"
        $artifactsUrl = "$workflowUrl#artifacts"
        
        Write-Host "üîó Workflow URL: $workflowUrl"
        Write-Host "üîó Artifacts URL: $artifactsUrl"
        
        if (-not (Test-Path "results.jtl")) {
            @"
        <!DOCTYPE html>
        <html>
        <head>
          <style>
            body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
            .container { max-width: 600px; margin: 0 auto; background: white; border-radius: 10px; padding: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
            .link-button { display: inline-block; margin: 10px 5px; padding: 12px 25px; background: #2196F3; color: white; text-decoration: none; border-radius: 5px; font-weight: bold; }
            .link-button:hover { background: #1976D2; }
          </style>
        </head>
        <body>
          <div class="container">
            <h1 style="color: red;">‚ùå Test Failed</h1>
            <p>No results were generated. Please check the workflow logs.</p>
            <a href="$workflowUrl" class="link-button">View Logs</a>
          </div>
        </body>
        </html>
        "@ | Out-File -FilePath "email-report.html" -Encoding utf8
            "failed" | Out-File -FilePath "test-status.txt"
            exit 0
        }
        
        $content = Get-Content "results.jtl"
        if ($content.Count -le 1) {
            @"
        <!DOCTYPE html>
        <html>
        <head>
          <style>
            body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
            .container { max-width: 600px; margin: 0 auto; background: white; border-radius: 10px; padding: 30px; }
          </style>
        </head>
        <body>
          <div class="container">
            <h1 style="color: orange;">‚ö†Ô∏è No Results</h1>
            <p>Test ran but produced no results.</p>
          </div>
        </body>
        </html>
        "@ | Out-File -FilePath "email-report.html" -Encoding utf8
            "no-results" | Out-File -FilePath "test-status.txt"
            exit 0
        }
        
        # Calculate metrics
        $totalSamples = $content.Count - 1
        $results = $content | Select-Object -Skip 1 | ForEach-Object {
            $fields = $_ -split ','
            if ($fields.Count -ge 8) {
                [PSCustomObject]@{
                    Success = ($fields[7] -eq 'true')
                    ResponseTime = if ($fields[1] -and $fields[1] -match '^\d+
        
        $successful = ($results | Where-Object { $_.Success -eq $true }).Count
        $failed = ($results | Where-Object { $_.Success -eq $false }).Count
        
        if ($totalSamples -eq 0) { $totalSamples = 1 }
        
        $successRate = [math]::Round(($successful / $totalSamples) * 100, 2)
        $avgTime = if ($results.Count -gt 0) { [math]::Round(($results | Measure-Object -Property ResponseTime -Average).Average, 2) } else { 0 }
        $maxTime = if ($results.Count -gt 0) { ($results | Measure-Object -Property ResponseTime -Maximum).Maximum } else { 0 }
        $minTime = if ($results.Count -gt 0) { ($results | Measure-Object -Property ResponseTime -Minimum).Minimum } else { 0 }
        
        $statusColor = if ($successRate -ge 95) { "#4CAF50" } elseif ($successRate -ge 80) { "#FF9800" } else { "#F44336" }
        $statusIcon = if ($successRate -ge 95) { "‚úÖ" } elseif ($successRate -ge 80) { "‚ö†Ô∏è" } else { "‚ùå" }
        
        # Save status
        "success" | Out-File -FilePath "test-status.txt"
        
        # Generate HTML email with Artifacts link
        @"
        <!DOCTYPE html>
        <html>
        <head>
          <style>
            body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; background: #f5f5f5; }
            .container { max-width: 650px; margin: 20px auto; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
            .header { background: $statusColor; color: white; padding: 30px; text-align: center; }
            .header h1 { margin: 0; font-size: 28px; }
            .content { padding: 30px; }
            .metric { display: flex; justify-content: space-between; padding: 15px; margin: 10px 0; background: #f9f9f9; border-radius: 5px; border-left: 4px solid $statusColor; }
            .metric-label { font-weight: bold; color: #666; }
            .metric-value { font-size: 18px; color: #333; font-weight: bold; }
            .download-section { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 10px; text-align: center; margin: 25px 0; color: white; }
            .download-section h2 { margin-top: 0; font-size: 24px; }
            .main-button { display: inline-block; padding: 18px 40px; background: white; color: #667eea; text-decoration: none; border-radius: 50px; font-weight: bold; font-size: 18px; margin: 15px 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); transition: transform 0.2s; }
            .main-button:hover { transform: scale(1.05); }
            .secondary-button { display: inline-block; padding: 12px 25px; background: rgba(255,255,255,0.2); color: white; text-decoration: none; border-radius: 25px; font-weight: bold; margin: 5px; border: 2px solid white; }
            .secondary-button:hover { background: rgba(255,255,255,0.3); }
            .instructions { background: #e8eaf6; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #3f51b5; }
            .instructions ol { margin: 10px 0; padding-left: 20px; }
            .instructions li { margin: 8px 0; line-height: 1.6; }
            .footer { background: #f5f5f5; padding: 20px; text-align: center; color: #666; font-size: 12px; }
            .artifact-preview { background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 15px 0; border: 2px dashed #dee2e6; }
            .artifact-item { display: flex; align-items: center; padding: 10px; margin: 8px 0; background: white; border-radius: 5px; }
            .artifact-icon { font-size: 24px; margin-right: 15px; }
            .artifact-name { font-weight: bold; color: #495057; }
            .artifact-size { color: #6c757d; font-size: 14px; margin-left: auto; }
          </style>
        </head>
        <body>
          <div class="container">
            <div class="header">
              <h1>$statusIcon Performance Test Report</h1>
              <p style="margin: 10px 0 0 0; font-size: 16px;">Run #${{ github.run_number }} - ${{ github.ref_name }}</p>
            </div>
            
            <div class="content">
              <h2 style="color: #333; border-bottom: 2px solid #e0e0e0; padding-bottom: 10px;">üìä Test Results Summary</h2>
              
              <div class="metric">
                <span class="metric-label">üìù Total Requests</span>
                <span class="metric-value">$totalSamples</span>
              </div>
              
              <div class="metric">
                <span class="metric-label">‚úÖ Successful</span>
                <span class="metric-value">$successful</span>
              </div>
              
              <div class="metric">
                <span class="metric-label">‚ùå Failed</span>
                <span class="metric-value">$failed</span>
              </div>
              
              <div class="metric">
                <span class="metric-label">üìà Success Rate</span>
                <span class="metric-value" style="color: $statusColor;">$successRate%</span>
              </div>
              
              <div class="metric">
                <span class="metric-label">‚è±Ô∏è Avg Response Time</span>
                <span class="metric-value">$avgTime ms</span>
              </div>
              
              <div class="metric">
                <span class="metric-label">‚ö° Min Response Time</span>
                <span class="metric-value">$minTime ms</span>
              </div>
              
              <div class="metric">
                <span class="metric-label">üî• Max Response Time</span>
                <span class="metric-value">$maxTime ms</span>
              </div>
              
              <div class="download-section">
                <h2>üì¶ Download Complete Report</h2>
                <p style="font-size: 16px; margin: 15px 0;">Click below to access all test artifacts and detailed HTML reports</p>
                
                <a href="$artifactsUrl" class="main-button">
                  üì• View & Download Reports
                </a>
                
                <div style="margin-top: 20px;">
                  <a href="$workflowUrl" class="secondary-button">
                    üìã View Workflow Details
                  </a>
                </div>
              </div>
              
              <div class="instructions">
                <h3 style="margin-top: 0; color: #3f51b5;">üìñ How to Download Reports:</h3>
                <ol>
                  <li>Click the <strong>"View & Download Reports"</strong> button above</li>
                  <li>Scroll down to the <strong>"Artifacts"</strong> section</li>
                  <li>Download <strong>"html-report"</strong> (contains full interactive dashboard)</li>
                  <li>Extract the ZIP file and open <strong>index.html</strong> in your browser</li>
                </ol>
              </div>
              
              <div class="artifact-preview">
                <h3 style="margin-top: 0; color: #495057;">üìÇ Available Artifacts:</h3>
                <div class="artifact-item">
                  <span class="artifact-icon">üìä</span>
                  <span class="artifact-name">html-report</span>
                  <span class="artifact-size">~1.1 MB</span>
                </div>
                <div class="artifact-item">
                  <span class="artifact-icon">üìÑ</span>
                  <span class="artifact-name">jtl-results</span>
                  <span class="artifact-size">~2.5 KB</span>
                </div>
                <div class="artifact-item">
                  <span class="artifact-icon">üìù</span>
                  <span class="artifact-name">jmeter-logs</span>
                  <span class="artifact-size">~4.9 KB</span>
                </div>
              </div>
            </div>
            
            <div class="footer">
              <p><strong>Repository:</strong> ${{ github.repository }}</p>
              <p><strong>Branch:</strong> ${{ github.ref_name }}</p>
              <p><strong>Triggered by:</strong> ${{ github.actor }}</p>
              <p><strong>Commit:</strong> ${{ github.sha }}</p>
              <hr style="border: 0; border-top: 1px solid #ddd; margin: 15px 0;">
              <p style="font-size: 11px; color: #999;">
                This is an automated email from JMeter Performance Testing Pipeline<br>
                Reports are retained for 30 days
              </p>
            </div>
          </div>
        </body>
        </html>
        "@ | Out-File -FilePath "email-report.html" -Encoding utf8
        
        Write-Host "‚úÖ Email report generated"
        Write-Host "================================"
        Write-Host "üìä TEST SUMMARY"
        Write-Host "================================"
        Write-Host "Total Requests: $totalSamples"
        Write-Host "Successful: $successful"
        Write-Host "Failed: $failed"
        Write-Host "Success Rate: $successRate%"
        Write-Host "Avg Response Time: $avgTime ms"
        Write-Host "================================"

    - name: üìß Send Email Report with Artifacts Link
      if: always()
      uses: dawidd6/action-send-mail@v3
      with:
        server_address: smtp.gmail.com
        server_port: 587
        username: ${{ secrets.EMAIL_USERNAME }}
        password: ${{ secrets.EMAIL_PASSWORD }}
        subject: "${{ env.RP_PROJECT }} Performance Test - Run #${{ github.run_number }}"
        to: ${{ env.RECIPIENT_EMAIL }}
        from: JMeter Bot <${{ secrets.EMAIL_USERNAME }}>
        html_body: file://email-report.html
        priority: normal
        ignore_cert: true
        convert_markdown: false

    - name: üì¶ Upload HTML Report
      if: always()
      uses: actions/upload-artifact@v4
      with:
        name: html-report
        path: html-report/
        retention-days: 30
        if-no-files-found: warn

    - name: üì¶ Upload JTL Results
      if: always()
      uses: actions/upload-artifact@v4
      with:
        name: jtl-results
        path: results.jtl
        retention-days: 30
        if-no-files-found: warn

    - name: üì¶ Upload JMeter Logs
      if: always()
      uses: actions/upload-artifact@v4
      with:
        name: jmeter-logs
        path: jmeter.log
        retention-days: 30
        if-no-files-found: warn

    - name: ‚úÖ Print Summary
      if: always()
      shell: pwsh
      run: |
        $workflowUrl = "${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}"
        $artifactsUrl = "$workflowUrl#artifacts"
        
        Write-Host "================================"
        Write-Host "üìß EMAIL SENT SUCCESSFULLY"
        Write-Host "================================"
        Write-Host "üîó Artifacts URL: $artifactsUrl"
        Write-Host "üîó Workflow URL: $workflowUrl"
        Write-Host ""
        Write-Host "üì¶ Recipients will receive:"
        Write-Host "  - Test summary with metrics"
        Write-Host "  - Direct link to download artifacts"
        Write-Host "  - Instructions for viewing reports"
        Write-Host "================================"
) { [int]$fields[1] } else { 0 }
                }
            }
        } | Where-Object { $_ -ne $null }
        
        $successful = ($results | Where-Object { $_.Success }).Count
        $failed = ($results | Where-Object { -not $_.Success }).Count
        $successRate = [math]::Round(($successful/$totalSamples)*100, 2)
        $avgTime = [math]::Round(($results | Measure-Object -Property ResponseTime -Average).Average, 2)
        $maxTime = ($results | Measure-Object -Property ResponseTime -Maximum).Maximum
        $minTime = ($results | Measure-Object -Property ResponseTime -Minimum).Minimum
        
        $statusColor = if ($successRate -ge 95) { "#4CAF50" } elseif ($successRate -ge 80) { "#FF9800" } else { "#F44336" }
        $statusIcon = if ($successRate -ge 95) { "‚úÖ" } elseif ($successRate -ge 80) { "‚ö†Ô∏è" } else { "‚ùå" }
        
        # Save status
        "success" | Out-File -FilePath "test-status.txt"
        
        # Generate HTML email with Artifacts link
        @"
        <!DOCTYPE html>
        <html>
        <head>
          <style>
            body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; background: #f5f5f5; }
            .container { max-width: 650px; margin: 20px auto; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
            .header { background: $statusColor; color: white; padding: 30px; text-align: center; }
            .header h1 { margin: 0; font-size: 28px; }
            .content { padding: 30px; }
            .metric { display: flex; justify-content: space-between; padding: 15px; margin: 10px 0; background: #f9f9f9; border-radius: 5px; border-left: 4px solid $statusColor; }
            .metric-label { font-weight: bold; color: #666; }
            .metric-value { font-size: 18px; color: #333; font-weight: bold; }
            .download-section { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 10px; text-align: center; margin: 25px 0; color: white; }
            .download-section h2 { margin-top: 0; font-size: 24px; }
            .main-button { display: inline-block; padding: 18px 40px; background: white; color: #667eea; text-decoration: none; border-radius: 50px; font-weight: bold; font-size: 18px; margin: 15px 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); transition: transform 0.2s; }
            .main-button:hover { transform: scale(1.05); }
            .secondary-button { display: inline-block; padding: 12px 25px; background: rgba(255,255,255,0.2); color: white; text-decoration: none; border-radius: 25px; font-weight: bold; margin: 5px; border: 2px solid white; }
            .secondary-button:hover { background: rgba(255,255,255,0.3); }
            .instructions { background: #e8eaf6; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #3f51b5; }
            .instructions ol { margin: 10px 0; padding-left: 20px; }
            .instructions li { margin: 8px 0; line-height: 1.6; }
            .footer { background: #f5f5f5; padding: 20px; text-align: center; color: #666; font-size: 12px; }
            .artifact-preview { background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 15px 0; border: 2px dashed #dee2e6; }
            .artifact-item { display: flex; align-items: center; padding: 10px; margin: 8px 0; background: white; border-radius: 5px; }
            .artifact-icon { font-size: 24px; margin-right: 15px; }
            .artifact-name { font-weight: bold; color: #495057; }
            .artifact-size { color: #6c757d; font-size: 14px; margin-left: auto; }
          </style>
        </head>
        <body>
          <div class="container">
            <div class="header">
              <h1>$statusIcon Performance Test Report</h1>
              <p style="margin: 10px 0 0 0; font-size: 16px;">Run #${{ github.run_number }} - ${{ github.ref_name }}</p>
            </div>
            
            <div class="content">
              <h2 style="color: #333; border-bottom: 2px solid #e0e0e0; padding-bottom: 10px;">üìä Test Results Summary</h2>
              
              <div class="metric">
                <span class="metric-label">üìù Total Requests</span>
                <span class="metric-value">$totalSamples</span>
              </div>
              
              <div class="metric">
                <span class="metric-label">‚úÖ Successful</span>
                <span class="metric-value">$successful</span>
              </div>
              
              <div class="metric">
                <span class="metric-label">‚ùå Failed</span>
                <span class="metric-value">$failed</span>
              </div>
              
              <div class="metric">
                <span class="metric-label">üìà Success Rate</span>
                <span class="metric-value" style="color: $statusColor;">$successRate%</span>
              </div>
              
              <div class="metric">
                <span class="metric-label">‚è±Ô∏è Avg Response Time</span>
                <span class="metric-value">$avgTime ms</span>
              </div>
              
              <div class="metric">
                <span class="metric-label">‚ö° Min Response Time</span>
                <span class="metric-value">$minTime ms</span>
              </div>
              
              <div class="metric">
                <span class="metric-label">üî• Max Response Time</span>
                <span class="metric-value">$maxTime ms</span>
              </div>
              
              <div class="download-section">
                <h2>üì¶ Download Complete Report</h2>
                <p style="font-size: 16px; margin: 15px 0;">Click below to access all test artifacts and detailed HTML reports</p>
                
                <a href="$artifactsUrl" class="main-button">
                  üì• View & Download Reports
                </a>
                
                <div style="margin-top: 20px;">
                  <a href="$workflowUrl" class="secondary-button">
                    üìã View Workflow Details
                  </a>
                </div>
              </div>
              
              <div class="instructions">
                <h3 style="margin-top: 0; color: #3f51b5;">üìñ How to Download Reports:</h3>
                <ol>
                  <li>Click the <strong>"View & Download Reports"</strong> button above</li>
                  <li>Scroll down to the <strong>"Artifacts"</strong> section</li>
                  <li>Download <strong>"html-report"</strong> (contains full interactive dashboard)</li>
                  <li>Extract the ZIP file and open <strong>index.html</strong> in your browser</li>
                </ol>
              </div>
              
              <div class="artifact-preview">
                <h3 style="margin-top: 0; color: #495057;">üìÇ Available Artifacts:</h3>
                <div class="artifact-item">
                  <span class="artifact-icon">üìä</span>
                  <span class="artifact-name">html-report</span>
                  <span class="artifact-size">~1.1 MB</span>
                </div>
                <div class="artifact-item">
                  <span class="artifact-icon">üìÑ</span>
                  <span class="artifact-name">jtl-results</span>
                  <span class="artifact-size">~2.5 KB</span>
                </div>
                <div class="artifact-item">
                  <span class="artifact-icon">üìù</span>
                  <span class="artifact-name">jmeter-logs</span>
                  <span class="artifact-size">~4.9 KB</span>
                </div>
              </div>
            </div>
            
            <div class="footer">
              <p><strong>Repository:</strong> ${{ github.repository }}</p>
              <p><strong>Branch:</strong> ${{ github.ref_name }}</p>
              <p><strong>Triggered by:</strong> ${{ github.actor }}</p>
              <p><strong>Commit:</strong> ${{ github.sha }}</p>
              <hr style="border: 0; border-top: 1px solid #ddd; margin: 15px 0;">
              <p style="font-size: 11px; color: #999;">
                This is an automated email from JMeter Performance Testing Pipeline<br>
                Reports are retained for 30 days
              </p>
            </div>
          </div>
        </body>
        </html>
        "@ | Out-File -FilePath "email-report.html" -Encoding utf8
        
        Write-Host "‚úÖ Email report generated"
        Write-Host "================================"
        Write-Host "üìä TEST SUMMARY"
        Write-Host "================================"
        Write-Host "Total Requests: $totalSamples"
        Write-Host "Successful: $successful"
        Write-Host "Failed: $failed"
        Write-Host "Success Rate: $successRate%"
        Write-Host "Avg Response Time: $avgTime ms"
        Write-Host "================================"

    - name: üìß Send Email Report with Artifacts Link
      if: always()
      uses: dawidd6/action-send-mail@v3
      with:
        server_address: smtp.gmail.com
        server_port: 587
        username: ${{ secrets.EMAIL_USERNAME }}
        password: ${{ secrets.EMAIL_PASSWORD }}
        subject: "${{ env.RP_PROJECT }} Performance Test - Run #${{ github.run_number }}"
        to: ${{ env.RECIPIENT_EMAIL }}
        from: JMeter Bot <${{ secrets.EMAIL_USERNAME }}>
        html_body: file://email-report.html
        priority: normal
        ignore_cert: true
        convert_markdown: false

    - name: üì¶ Upload HTML Report
      if: always()
      uses: actions/upload-artifact@v4
      with:
        name: html-report
        path: html-report/
        retention-days: 30
        if-no-files-found: warn

    - name: üì¶ Upload JTL Results
      if: always()
      uses: actions/upload-artifact@v4
      with:
        name: jtl-results
        path: results.jtl
        retention-days: 30
        if-no-files-found: warn

    - name: üì¶ Upload JMeter Logs
      if: always()
      uses: actions/upload-artifact@v4
      with:
        name: jmeter-logs
        path: jmeter.log
        retention-days: 30
        if-no-files-found: warn

    - name: ‚úÖ Print Summary
      if: always()
      shell: pwsh
      run: |
        $workflowUrl = "${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}"
        $artifactsUrl = "$workflowUrl#artifacts"
        
        Write-Host "================================"
        Write-Host "üìß EMAIL SENT SUCCESSFULLY"
        Write-Host "================================"
        Write-Host "üîó Artifacts URL: $artifactsUrl"
        Write-Host "üîó Workflow URL: $workflowUrl"
        Write-Host ""
        Write-Host "üì¶ Recipients will receive:"
        Write-Host "  - Test summary with metrics"
        Write-Host "  - Direct link to download artifacts"
        Write-Host "  - Instructions for viewing reports"
        Write-Host "================================"
